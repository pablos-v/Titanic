# Тестовое задание "Список пассажиров Титаника".

Описание

При первом запуске скачать данные с сайта https://web.stanford.edu/class/archive/cs/cs109/cs109.1166/problem12.html, ссылка на файл с данными (https://web.stanford.edu/class/archive/cs/cs109/cs109.1166/stuff/titanic.csv). Данные записать в базу данных, при записи часть данных модифицировать: данные о классе пассажира (Pclass) заменить на Enum, идентификатор выжившего (Survived) заменить на тип данных Boolean.

Пользователь попадает на экран со списком пассажиров Титаника. На странице должно отображаться 50 пассажиров, должна быть возможность изменять количество отображаемых пассажиров на странице. Также должна быть пагинация. 

Должна быть возможность сортировать (по возрастанию, по убыванию) список по полям: Имя, Возраст, Оплата.
На странице должно быть поле поиска пассажира по имени. 

В нижней части списка должна быть статистика по следующим полям:
- Общая сумма оплаты проезда
- Количество людей имеющих родственников на борту.
- Количество выживших на борту.     

Данная статистика должна меняться в зависимости от фильтрованных данных, но по всем пассажирам, а не только тех что на экране.

На экране должны быть кнопки которые фильтруют данные:
- показать всех выживших пассажиров. 
- показать всех совершеннолетих пассажирова (страше 16 лет)
- показать всех пассажиров мужского пола
- показать всех пассажиров кто не имеет родственников. 

Должна быть возможность комбинировать фильтры.
Должно быть реализовано кэширование данных, выбор технологии кэширования на своё усмотрение.

Требования к результату
- Код приложения необходимо снабдить комментариями.
- Приложение должно собираться при помощи maven без установки или настройки каких-либо дополнительных компонент;
- Должен быть заполнен текстовый файл readme.md с инструкцией по сборке, настройке, конфигурированию и развертыванию приложения (если необходимо);
- Результаты должны быть загружены на GitHub/GitLab (желательно вести последовательную разработку: один коммит - одна фича).

## Задание выполнено

### Описание проведённых работ
- Приложение работает на Spring Cloud: 3 отдельных микросервиса (Eureka, Backend, Frontend).
- Бэкенд работает c БД PostgreSQL 12 посредством Spring Data JPA. 
- Миграциями управляет Liquibase.
- Реализовано кэширование с помощью Redis. 
- Подключено логирование logback.
- Фронтенд реализован на шаблонах Thymeleaf с использованием HTML/CSS/JS.
- Добавлены Docker файлы для всех компонентов и оркестрация через docker-compose.yaml
- Приложение развёрнуто по адресу: http://87.242.86.91:8089/

### Скриншот страницы
![](image.png)

### Самостоятельное развёртывание
Сначала нужно получить исходники: git clone https://github.com/pablos-v/Titanic
\
Далее, в файле Backend/src/main/resources/application.yaml в properties можно изменить 2 параметра:
\
URL загрузки файла - URL: https://web.stanford.edu/class/archive/cs/cs109/cs109.1166/stuff/titanic.csv
\
критерий совершеннолетия - adultAgeCriteria: 16 

#### Далее есть 2 варианта развёртывания
1. Запустить команду docker-compose up.
2. Для развёртывания приложения необходимо иметь запущенные БД Postgres и Redis, соответствующие описанию из
   docker-compose.yaml
   \
   Модули запускаются вручную консольными командами из общей папки:
   - mvn -f Eureka clean package && java -jar Eureka/target/Eureka-0.0.1.jar
   - mvn -f Backend clean package && java -jar Backend/target/Backend-0.0.1.jar
   - mvn -f Frontend clean package && java -jar Frontend/target/Frontend-0.0.1.jar

Страница со списком пассажиров будет доступна по адресу: http://localhost:8089

### Примечания
По пагинации: изначально хотел реализовать через Thymeleaf, чтобы каждая страница формировалась новыми запросами типа /?page=
\
Но потом подумал, что каждый раз слать запрос и отрисавывать страницу при таком малом объёме данных - так себе идея. 
\
Лучше сразу передавать весь отфильтрованный список, и уже на месте сделать пагинацию через JS. 
\
Сам я на JS писать не умею - нашёл готовое решение и подружил с шаблоном Thymeleaf.

### Возможные оптимизации
- бэкенд в ответе возвращает индикаторы фильтров, которые были в запросе - на их основе можно сделать на странице отображение всех параметров отправленного запроса - сейчас это можно понять только по адресной строке, а все фильтры сбрасываются на значения по умолчанию.
- создать стартер содержащий дублирующиеся DTO и Enum, чтобы избежать дублирования кода
- свести переменные вроде Url файла и критерия совершеннолетия в .env файл, и добавить их в environment докерфайлов

